<!DOCTYPE html>
<html>
<head>

    <link rel="stylesheet" href="css/main.css">

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
</head>
<body onload="listWareHouses()">
<h1>
    <marquee bgcolor=orange behavior=alternate> Inventory Tracking System v1.0 </marquee>
</h1>

<fieldset>
    <legend>List the WareHouses</legend>

    <table>
        <thead>
        <tr id="e_header">
            <th>Warehouse ID</th>
            <th>Warehouse Name</th>
            <th>WareHouse Location</th>
            <th>Item Name</th>
            <th>Item Number</th>
        </tr>

        </thead>

        <tbody id="e_table">

        </tbody>

    </table>

</fieldset>

<div>
        <a href="mainpage.html"><button class="btn btn-success">Return Back</button></a></div>

</div>

</div>
<script type="text/javascript">



    function listWareHouses(){


        var xhr = new XMLHttpRequest();
        var url = "/listWareHouse";
        xhr.open("GET", url, true);
        xhr.setRequestHeader("Content-Type", "application/json");
        xhr.onreadystatechange = function () {
            if (xhr.readyState === 4) {
                if (xhr.status === 200) {
                    var parseResponse = JSON.parse(xhr.responseText);
                    // if (parseResponse.getAll().indexOf(2) == null){
                    //     createTable(parseResponse);
                    //
                    // }
                    //alert(xhr.responseText);

                        createTable(parseResponse)

                }
                else {
                    alert(xhr.responseText);
                }
            }
        };
        xhr.send();
    }

    function createTable(object) {
        var e_table = document.getElementById("e_table");

        e_table.innerHTML = "";
        for(var i = 0; i < object.length; i++){
            addRowToTable(object[i]);
        }

    }
    function addRowToTable(object) {




        // td_wareHouseName.innerHTML = object.warehousename;
        // td_wareHouseLocation.innerHTML = object.warehouselocation;
        // tr_table.appendChild(td_wareHouseName);
        // tr_table.appendChild(td_wareHouseLocation);
        if(object.inventoryItems.length > 0)
        {
            for(var i = 0; i < object.inventoryItems.length; i++){

                var e_table = document.getElementById("e_table");
                var tr_table = document.createElement("tr");
                e_table.appendChild(tr_table);

                var td_wareHouseID = document.createElement("td");
                var td_wareHouseName = document.createElement("td");
                var td_wareHouseLocation = document.createElement("td");
                var td_itemName = document.createElement("td");
                var td_itemNumber = document.createElement("td");

                td_wareHouseID.innerHTML = object.id;
                td_wareHouseName.innerHTML = object.warehousename;
                td_wareHouseLocation.innerHTML = object.warehouselocation;
                tr_table.appendChild(td_wareHouseID);
                tr_table.appendChild(td_wareHouseName);
                tr_table.appendChild(td_wareHouseLocation);


                var itemName = object.inventoryItems[i].itemName;
                var itemNumber = object.inventoryItems[i].number;

                td_itemName.innerHTML = itemName;
                td_itemNumber.innerHTML = itemNumber;


                tr_table.appendChild(td_itemName);
                tr_table.appendChild(td_itemNumber);
            }
        }
        else {
            var e_table = document.getElementById("e_table");
            var tr_table = document.createElement("tr");
            e_table.appendChild(tr_table);

            var td_wareHouseID = document.createElement("td");
            var td_wareHouseName = document.createElement("td");
            var td_wareHouseLocation = document.createElement("td");

            td_wareHouseID.innerHTML = object.id;
            td_wareHouseName.innerHTML = object.warehousename;
            td_wareHouseLocation.innerHTML = object.warehouselocation;
            tr_table.appendChild(td_wareHouseID);
            tr_table.appendChild(td_wareHouseName);
            tr_table.appendChild(td_wareHouseLocation);


        }




    }



</script>

</body>

</html>
